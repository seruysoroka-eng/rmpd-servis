<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>RMPD Servis – Моніторинг 406</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root{--accent:#005bbb;--bg:#f8fafc;--text:#111;--tile:#fff;--shadow:0 2px 8px rgba(0,0,0,.08)}
    @media (prefers-color: dark){
      :root{--bg:#0f172a;--text:#f1f5f9;--tile:#1e293b}
    }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;padding:2rem 1rem;min-height:100vh}
    header{margin-bottom:2rem;text-align:center}
    .logo{font-size:1.8rem;font-weight:700;color:var(--accent)}
    .sub{text-align:center;font-size:1rem;color:#64748b;margin:.5rem 0 2rem}
    .card{width:100%;max-width:640px;background:var(--tile);border-radius:12px;box-shadow:var(--shadow);padding:1.5rem}
    input{width:100%;padding:.9rem 1.2rem;font-size:1rem;border:2px solid #e2e8f0;border-radius:8px;margin-bottom:1.2rem}
    input:focus{outline:none;border-color:var(--accent)}
    #status{font-size:1.3rem;margin-bottom:1rem}
    #screen img{width:100%;border-radius:8px}
    .info{font-size:.85rem;color:#64748b;text-align:center;margin-top:1rem}
    footer{margin-top:auto;padding-top:2rem;font-size:.75rem;color:#64748b}
  </style>
</head>
  <header>
  <div class="logo">RMPD Servis</div>
  <nav>
    <a href="carrier.html">Кабінет перевізника</a>
    <a href="https://t.me/YOUR_BOT_NAME?start=track" target="_blank">Telegram /track</a>
  </nav>
</header>
<body>
  <header>
    <div class="logo">RMPD Servis</div>
    <div class="sub">Моніторинг статусу вантажу RMPD-406 (SENT)</div>
  </header>

  <main class="card">
    <input id="rmpd" placeholder="Введіть номер заявки RMPD (напр. 406/2025/12345)">
    <button id="check" onclick="checkStatus()">Перевірити</button>

    <div id="result" style="display:none">
      <div id="status"></div>
      <div id="screen"></div>
    </div>
  </main>

  <footer>Оновлення кожні 20 хв • Джерело: puesc.gov.pl</footer>

  <script>
    // при натисканні «Перевірити» беремо номер і показуємо ОСТАННІЙ загальний скрін
    function checkStatus(){
      const nr = document.getElementById('rmpd').value.trim();
      if(!nr){ alert('Введіть номер заявки'); return; }
      // показуємо останній загальний статус (без глибокого парсингу – поки що)
      fetch('status.json?t='+Date.now())
        .then(r=>r.json())
        .then(d=>{
          document.getElementById('status').innerText = d.status;
          const img = document.createElement('img');
          img.src = d.screen;
          document.getElementById('screen').innerHTML = '';
          document.getElementById('screen').appendChild(img);
          document.getElementById('result').style.display = 'block';
        })
        .catch(e=>{ alert('Не вдалося завантажити дані'); console.error(e); });
    }
    // автоматичне оновлення кожні 20 хв
    setInterval(()=>{ fetch('status.json?t='+Date.now()).then(r=>r.json()).then(d=>{
      document.getElementById('status') && (document.getElementById('status').innerText = d.status);
      const img = document.querySelector('#screen img');
      if(img) img.src = d.screen;
    }).catch(()=>{}); },20*60*1000);
  </script>
</body>
</html>
